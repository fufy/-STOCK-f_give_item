#include <amxmodx>
#include <engine>
#include <cstrike>
#include <fun>

public plugin_init()
{
	register_plugin( "give_weapon Test", "x", "x" );

	register_clcmd( "say /d", "DeagleCMD" );
}

public DeagleCMD( id )
{
	// Ar trebui sa dea deagle cu 1 singur glont.
	give_weapon( id, "deagle", 1, 0 );
}

stock give_weapon( id, wp[], iClip = 0, iBPAmmo = 0 )
{
	new wp_id[ 60 ];
	formatex( wp_id, charsmax( wp_id ), "weapon_%s",wp);

	new csw_id[ 60 ];
	formatex( csw_id, charsmax( csw_id ), "CSW_%s", strtoupper( wp ) );
	
	new CSWID = str_to_num( csw_id );

	if( is_user_alive( id ) )
	{
		if( user_has_weapon( id, CSWID ) ) 
		{   
			cs_set_weapon_ammo( find_ent_by_owner(-1, wp_id, id ), iClip );
			cs_set_user_bpammo(id, CSWID, iBPAmmo); 
		}
 		else
		{
			give_item( id, wp_id );

			cs_set_weapon_ammo( find_ent_by_owner(-1, wp_id, id ), iClip );
			cs_set_user_bpammo(id, CSWID, iBPAmmo); 
		}
	}
}
